!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],b):a.amdWeb=b(a.b)}(this,function(a){"use strict";var b,c;c={fps:60,columns:0,rows:0,frames:0,sprites:[],ratio:1.5,autoPlay:!1,loop:!1};var d=Date.now(),e=function(){return(d++).toString(36)};return b=function(b,d){this.$el=a(b),this.options=a.extend({},c,d),this.id=this.options.id||this.$el.attr("id")||e(),this.container={},this.state={loaded:!1,playing:!1,ended:!1},this.init()},b.prototype={loaded:0,currentFrame:0,init:function(){var a=this;this.loadSprites(function(){a.setState("loaded",!0),a.createContainer(),a.options.autoPlay&&a.play()}),this.enable(),this.setHeight()},enable:function(){a(window).on("resize."+this.id,a.proxy(this,"onResize"))},disable:function(){a(window).off("."+this.id)},destroy:function(){this.$el.empty(),this.disable()},createContainer:function(){var b=a('<div class="sprite-container"></div>');this.$el.append(b),this.setContainerWidth();for(var c=0;c<this.options.sprites.length;c++){var d=new Image;d.src=this.options.sprites[c],this.$el.find(".sprite-container").append(d)}},setContainerWidth:function(){this.$el.find(".sprite-container").length&&this.$el.find(".sprite-container").width(this.container.width*(this.$el.width()/this.options.frameWidth)).height(this.container.height)},setState:function(a,b){this.state[a]!==b&&(this.state[a]=b,this.$el.trigger(a,b))},onResize:function(){var a=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){a.setHeight(),a.setContainerWidth()},100)},setHeight:function(){var a=this.options.ratio;this.$el.height(this.$el.width()/a)},loadSprites:function(b){for(var c=this.options.sprites,d=0;d<c.length;d++){var e,f;e=c[d],f=new Image,a(f).one("load",a.proxy(this,"onSpriteLoaded",b)).one("error",a.proxy(this,"onSpriteError")),f.src=e}},onSpriteLoaded:function(b,c){this.container.width=c.target.width,this.container.height=(this.container.height||0)+c.target.height,this.loaded++,this.options.sprites.length===this.loaded&&a.isFunction(b)&&b()},onSpriteError:function(a){throw"Sprite failed to load"},setFrame:function(a){var b=-(this.options.frameWidth*(this.$el.width()/this.options.frameWidth))*(a%this.options.columns),c=-(this.options.frameHeight*(this.$el.width()/this.options.frameWidth))*Math.floor(a/this.options.columns);this.hasTransform()?this.$el.find(".sprite-container").css({"-webkit-transform":"translate("+b+"px, "+c+"px)","-ms-transform":"translate("+b+"px, "+c+"px)",transform:"translate("+b+"px, "+c+"px)"}):this.$el.find(".sprite-container").css({left:b+"px",top:c+"px",position:"absolute"})},hasTransform:function(){for(var a="transform WebkitTransform MozTransform OTransform msTransform".split(" "),b=document.createElement("div"),c=0;c<a.length;c++)if(b&&void 0!==b.style[a[c]])return a[c];return!1},goToAndPlay:function(a){this.currentFrame=a,this.play()},play:function(){var b=1e3/this.options.fps;return this.setState("playing",!0),this.setState("ended",!1),this.currentFrame>=this.options.frames&&!this.options.loop?(this.setState("ended",!0),void this.setState("playing",!1)):(this.currentFrame>=this.options.frames&&this.options.loop&&(this.currentFrame=0),this.setFrame(this.currentFrame),this.currentFrame++,void(this.ticker=setTimeout(a.proxy(this,"play"),b)))},pause:function(){this.ticker&&(clearInterval(this.ticker),this.setState("playing",!1))}},b});